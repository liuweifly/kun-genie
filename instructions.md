# 每日一签产品需求文档

## 1. 产品概述
### 1.1 产品背景
本产品旨在帮助用户通过输入姓名、性别和生辰时间，计算并展示用户的每日运势。基于八字、喜用神、流年月日等传统算法，提供准确的每日运势分析，包括总运势、爱情、财富、事业四大领域，并提供相关的开运建议。

### 1.2 产品目标
- 提供精准的每日运势计算结果。
- 提供优雅、简洁的页面交互体验，使用户能够轻松获取运势信息。
- 帮助用户了解每日运势并提供针对性的开运建议。

## 2. 产品功能
### 2.1 用户输入模块
- 功能描述：用户在页面头部输入姓名、性别和生辰时间。
- 输入项：
  - 姓名：文本框，支持汉字、英文。
  - 性别：单选按钮，选项为“男”/“女”。
  - 生辰时间：时间选择器，包括年、月、日、时四项。
### 2.2 运势计算模块
- 功能描述：基于用户输入的信息，通过八字、喜用神、流年月日等规则，计算并生成用户每日运势。
- 计算维度：
  - 总运势
  - 爱情运势
  - 财富运势
  - 事业运势
- 算法说明：参考传统命理规则，结合用户的八字信息和当前流年流月的变化，进行详细的运势计算。
### 2.3 运势展示模块
- 功能描述：在页面下半部分展示用户的今日运势数据，并提供个性化的开运建议。
- 展示内容：
  - 今日总运势：显示一个概述性评分（1-5星）和简要描述。
  - 爱情运势：评分和文字描述，结合建议。
  - 财富运势：评分和文字描述，结合建议。
  - 事业运势：评分和文字描述，结合建议。
  - 开运建议：根据计算结果生成开运建议，如适合的颜色、出行时间等。

## 3. 产品架构

### 3.1 页面结构与交互设计
#### 3.1.1 页面结构
- 页面头部：用户输入区域，包含姓名、性别和生辰时间输入项。
- 页面下半部分：运势展示区域，包括各项运势评分和描述，以及开运建议。
![alt text](public/md/UX.png)
#### 3.1.2 交互设计
- 输入验证：当用户输入姓名、性别或生辰时间时，页面会实时进行数据验证。所有必填项未填时，提示“请输入完整信息”。
- 计算按钮：用户输入信息后，点击“计算”按钮触发运势计算。计算完成后页面会自动滑动至结果展示区域。
- 动态更新：运势结果展示区域根据不同日期或用户信息变化而自动更新。
#### 3.1.3 用户体验优化
- 优雅的动画过渡：输入完成后页面展示运势结果时，采用渐入效果，提升用户体验。
- 响应式布局：页面兼容不同设备，确保在移动端和PC端均有良好的展示效果。
#### 3.1.4 颜色
- 主色调：采用黑白配色，后期再调整
- 图标：在运势展示区加入小图标，比如爱心图标用于爱情运势，金币图标用于财富运势等，以提升视觉效果和易读性。
![alt text](public/md/qrGPT.png)
### 3.2 后端
- 功能描述：后端负责接收前端请求，进行运势计算，并返回结果。
- 这里会是难点，也是项目的精华所在，如何将八字、喜用神、流年月日等信息结合起来，形成一个完整的运势计算结果。
- 登录信息，如果在微信场景传播，可以采用微信登录。前期可以不需要
### 3.3 数据库表设计
#### 3.3.1 用户信息表（Users）
- `user_id` (INT, PRIMARY KEY, AUTO_INCREMENT) - 用户唯一标识
- `name` (VARCHAR(50)) - 用户姓名
- `gender` (VARCHAR(10)) - 用户性别（“男”或“女”）
- `birth_datetime` (DATETIME) - 用户生辰时间
- `created_at` (TIMESTAMP) - 记录创建时间
- `updated_at` (TIMESTAMP) - 记录更新时间

#### 3.3.2 运势计算记录表（DailyFortune）  
- `record_id` (INT, PRIMARY KEY, AUTO_INCREMENT) - 记录唯一标识
- `user_id` (INT, FOREIGN KEY) - 对应用户ID
- `fortune_date` (DATE) - 计算运势的日期
- `overall_score` (INT) - 总运势评分（1-5）
- `love_score` (INT) - 爱情运势评分（1-5）
- `wealth_score` (INT) - 财富运势评分（1-5）
- `career_score` (INT) - 事业运势评分（1-5）
- `fortune_description` (TEXT) - 运势描述
- `opening_advice` (TEXT) - 开运建议
- `created_at` (TIMESTAMP) - 记录生成时间

## 4. 技术选型
- [Next.js](https://nextjs.org/) & [Tailwind](https://tailwindcss.com/) for frontend
- [Vercel postgreSQL](https://vercel.com/docs/concepts/databases/postgres) for database
- [Lunar](https://github.com/lunar-js/lunar) for Bazi calculation
- [Dify](https://www.dify.ai/) for LLM
- XXX for luck calculation

## 5. 开发流程

1. qrGPT中的form page代码，以及各种组件代码可以复用的都拿过来；先把前端展示样式调通，数据库先暂时不动。除了配色以外，其他都是最终稿。
2. 接入数据库，配合展示，决策是用KV还是postgreSQL
3. 接入后端，完成运势计算
4. 接入LLM，完成运势分析
5. 整体微调，完成最终稿
